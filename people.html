<!DOCTYPE HTML>
<html lang='en'>

<head>
    <title>SWF </title>
    <link rel="icon" href="images/favicon.ico">
    <!-- <link rel="icon" href="images/favicon.png"> -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" /> <!-- , user-scalable=no -->
    <link rel="stylesheet" href="assets/css/main.css" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4L9XEBTBVZ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-4L9XEBTBVZ');
    </script>
</head>

<body class="homepage is-preload">
    <div id="page-wrapper">

        <!-- Header -->
        <!-- <header id="header">
            <div class="logo container">
                <div>
                    <h2><a href="index.html" id="logo"></a>SWF</h2>

                </div>
            </div>
        </header> -->


        <!-- Navbar -->
        <nav id="nav"></nav>

        <!-- Main -->
        <section id="main">
            <div class="container">
                <div class="row gtr-200">
                    <div class="col-12">
                        <section id="people">
                        </section>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer id="footer"></footer>

    </div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.dropotron.min.js"></script>
    <script src="assets/js/jquery.csv.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js//participant.js"></script>
    <script>
        $(function () {
            $("#nav").load("includes/nav.html");
            $("#footer").load("includes/footer.html");
        });
    </script>
    <script>
        $(function () {
           
            
            $.get("/people.csv").then(function (text, status, xhr) {
                var data = $.csv.toObjects(text);
                
                // finds all the headers in the csv file
                let headers = [];
                for(let i = 0; i < data.length; i++){
                    if(data[i].ID == "HEADER"){
                        headers.push(i);
                    }
                }
                //add the last index because we sort from header to header sections 
                headers.push(data.length - 1)

                //take the data between 2 headers
                for(let i = 0; i < headers.length - 1; i++){
                    let start = headers[i] + 1;
                    // for first section leave Josh and Sarah as the first two
                    if(i == 0){
                        start = 3;
                    }
                    let end = headers[i+1];
                    // sort by last name
                    for (let j = start; j < end - 1; j++){
                        let min = data[j].LNAME;
                        let index = j;
                        for(let k = j + 1; k < end; k++){
                            if(data[k].LNAME < min){
                                min = data[k].LNAME;
                                index = k;
                            }
                        }
                        let temp = data[index];
                        data[index] = data[j]
                        data[j] = temp;
                    }
                }
                
                
                for (var i = 0; i < data.length; i++) {
                    let curr = data[i];    
                    switch (data[i].ID) {
                        case "HEADER":
                            $("#people").append(
                                $.parseHTML(
                                    '<section class="box highlight"><h2 class="major2top">' +
                                    '<span>' + data[i].LNAME + '</span></h2><div class="row">'
                                )
                            );
                            break;
                        default:
                            $("#people").append(
                                $.parseHTML(
                                    // '<a id =' + data[i].ID + '>'+
                                    ((window.innerWidth < 550) ? '<div style="display:inline-block;width:50%;height:20em;padding:4px;vertical-align:top;">' :
                                        '<div style="display:inline-block;width:20%;height:25em;padding:4px;vertical-align:top;">') +
                                    '<section class="box feature">' +
                                    '<a class="image featured img-overlay" onclick="show('+i+')")><img' +
                                    (((data[i].ID).toString() === '') ? ' src="images/participants/defaultprofile.jpg" alt="" />' :
                                        ' src="images/participants/' + data[i].ID + '.jpg" alt="" />') +
                                    // ' src="images/participants/' + data[i].ID + '.jpg" alt="" />' + 
                                    (((data[i].BIO).toString() === '') ? '' :
                                        '<div class="overlay"><p class="u-custom-scrollbar text">' + data[i].BIO + '</p></div>') +
                                    '</a>' +
                                    '<h3>' + data[i].FNAME + ' ' + data[i].LNAME + '</h3>' +
                                    // '<h5>' + data[i].ROLE + '</h5>' +
                                    '<h6>' + data[i].INSTITUTION + '</h6>' +
                                    '</section>' +
                                    '</div>'
                                    // + '</a>'  
                                )
                            );
                            break;
                    }
                }
                
                $("#people").append(
                    $.parseHTML(
                        '</section>'
                    )
                );
                
            });
        });
        
    </script>
    <script>
        //make a default "pop up" card 
        //on click  pop up the card
        //have a an x button to close it out 
        //pressing esc also closes it 
        //vicelab.ucmerced.edu for reference 
    
        
        function show(index){
            $.get("/people.csv").then(function (text, status, xhr) {
                var data = $.csv.toObjects(text);
                
                let headers = [];
                for(let i = 0; i < data.length; i++){
                    if(data[i].ID == "HEADER"){
                        headers.push(i);
                    }
                }
                //add the last index because we sort from header to header sections 
                headers.push(data.length - 1)

                //take the data between 2 headers
                for(let i = 0; i < headers.length - 1; i++){
                    let start = headers[i] + 1;
                    // for first section leave Josh and Sarah as the first two
                    if(i == 0){
                        start = 3;
                    }
                    let end = headers[i+1];
                    // sort by last name
                    for (let j = start; j < end - 1; j++){
                        let min = data[j].LNAME;
                        let index = j;
                        for(let k = j + 1; k < end; k++){
                            if(data[k].LNAME < min){
                                min = data[k].LNAME;
                                index = k;
                            }
                        }
                        let temp = data[index];
                        data[index] = data[j]
                        data[j] = temp;
                    }
                }

                console.log(data[index])
            },
            
        )}
       
        
    </script>



</body>

</html>